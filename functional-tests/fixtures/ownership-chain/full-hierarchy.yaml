# Complete ownership chain hierarchy for testing
# Apply in order: ApplicationService -> KafkaCluster -> ServiceAccount -> Topic/ACL/ConsumerGroup
---
apiVersion: messaging.example.com/v1
kind: ApplicationService
metadata:
  name: chain-app
spec:
  name: chain-app
  displayName: Ownership Chain Test Application
---
apiVersion: messaging.example.com/v1
kind: KafkaCluster
metadata:
  name: chain-vc
spec:
  clusterId: chain-vc
  applicationServiceRef: chain-app
---
apiVersion: messaging.example.com/v1
kind: ServiceAccount
metadata:
  name: chain-sa
spec:
  name: chain-sa
  dn:
    - "CN=chain-sa"
  clusterRef: chain-vc
  applicationServiceRef: chain-app
---
apiVersion: messaging.example.com/v1
kind: Topic
metadata:
  name: chain-topic
spec:
  name: chain-topic
  serviceRef: chain-sa
  applicationServiceRef: chain-app
  partitions: 3
  replicationFactor: 1
---
apiVersion: messaging.example.com/v1
kind: ConsumerGroup
metadata:
  name: chain-cg
spec:
  name: chain-cg
  serviceRef: chain-sa
  applicationServiceRef: chain-app
---
apiVersion: messaging.example.com/v1
kind: ACL
metadata:
  name: chain-acl
spec:
  name: chain-acl
  serviceRef: chain-sa
  applicationServiceRef: chain-app
  resourceType: TOPIC
  resourceName: chain-topic
  patternType: LITERAL
  principal: "User:chain-sa"
  host: "*"
  operation: READ
  permission: ALLOW
